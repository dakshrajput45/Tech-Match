{"ast":null,"code":"import axios from\"axios\";import Chat from\"./Chat\";import ChatInput from\"./ChatInput\";import{Base_url}from\"../pages/url\";import{useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ChatDisplay=_ref=>{let{user,clickedUser}=_ref;const[userMessages,setuserMessages]=useState(null);const[clickedUsermessages,setClickedUserMessages]=useState(null);const userId=user===null||user===void 0?void 0:user.user_id;const clickedUserId=clickedUser===null||clickedUser===void 0?void 0:clickedUser.user_id;const getUserMessages=async()=>{try{const response=await axios.get(\"\".concat(Base_url,\"/messages\"),{params:{userId:userId,correspondingUserId:clickedUserId}});setuserMessages(response.data);}catch(error){console.log(error);}};const getClickedUserMessages=async()=>{try{const response=await axios.get(\"\".concat(Base_url,\"/messages\"),{params:{userId:clickedUserId,correspondingUserId:userId}});setClickedUserMessages(response.data);}catch(error){console.log(error);}};useEffect(()=>{getUserMessages();getClickedUserMessages();},[]);const messages=[];userMessages===null||userMessages===void 0?void 0:userMessages.forEach(message=>{const formattedMessages={};formattedMessages['name']=user===null||user===void 0?void 0:user.first_name;formattedMessages['img']=user===null||user===void 0?void 0:user.url;formattedMessages['message']=message.message;formattedMessages['timestamp']=message.timestamp;messages.push(formattedMessages);});clickedUsermessages===null||clickedUsermessages===void 0?void 0:clickedUsermessages.forEach(message=>{const formattedMessages={};formattedMessages['name']=clickedUser===null||clickedUser===void 0?void 0:clickedUser.first_name;formattedMessages['img']=clickedUser===null||clickedUser===void 0?void 0:clickedUser.url;formattedMessages['message']=message.message;formattedMessages['timestamp']=message.timestamp;messages.push(formattedMessages);});const decendingOrderMessages=messages===null||messages===void 0?void 0:messages.sort((a,b)=>a.timestamp.localeCompare(b.timestamp));return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Chat,{decendingOrderMessages:decendingOrderMessages}),/*#__PURE__*/_jsx(ChatInput,{user:user,clickedUser:clickedUser,getUserMessages:getUserMessages,getClickedUsersMessages:getClickedUserMessages})]});};export default ChatDisplay;","map":{"version":3,"names":["axios","Chat","ChatInput","Base_url","useEffect","useState","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ChatDisplay","_ref","user","clickedUser","userMessages","setuserMessages","clickedUsermessages","setClickedUserMessages","userId","user_id","clickedUserId","getUserMessages","response","get","concat","params","correspondingUserId","data","error","console","log","getClickedUserMessages","messages","forEach","message","formattedMessages","first_name","url","timestamp","push","decendingOrderMessages","sort","a","b","localeCompare","children","getClickedUsersMessages"],"sources":["C:/Users/cnb/coding_18march/project(happy deepali)/client/src/component/ChatDisplay.js"],"sourcesContent":["import axios from \"axios\";\r\nimport Chat from \"./Chat\";\r\nimport ChatInput from \"./ChatInput\";\r\nimport { Base_url } from \"../pages/url\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nconst ChatDisplay = ({user, clickedUser}) => {\r\n    const [userMessages,setuserMessages]=useState(null)\r\n    const [clickedUsermessages,setClickedUserMessages]=useState(null)\r\n    const userId=user?.user_id\r\n    const clickedUserId = clickedUser?.user_id\r\n\r\n    const getUserMessages = async()=>\r\n    {\r\n        try{\r\n            const response = await axios.get(`${Base_url}/messages`,{\r\n                params: {userId: userId, correspondingUserId: clickedUserId}\r\n            })\r\n            setuserMessages(response.data)\r\n        }catch(error)\r\n        {\r\n            console.log(error)\r\n        }\r\n    }\r\n    const getClickedUserMessages = async() =>\r\n    {\r\n        try{\r\n            const response = await axios.get(`${Base_url}/messages`,{\r\n                params: {userId: clickedUserId, correspondingUserId: userId}\r\n            })\r\n            setClickedUserMessages(response.data)\r\n        }catch(error)\r\n        {\r\n            console.log(error)\r\n        }\r\n    } \r\n\r\n    useEffect(()=>{\r\n        getUserMessages()\r\n        getClickedUserMessages()\r\n    },[])\r\n\r\n    const messages=[]\r\n\r\n    userMessages?.forEach(message => {\r\n        const formattedMessages ={}\r\n        formattedMessages['name']= user?.first_name\r\n        formattedMessages['img']= user?.url\r\n        formattedMessages['message']= message.message\r\n        formattedMessages['timestamp']=message.timestamp\r\n        messages.push(formattedMessages)\r\n    })\r\n    clickedUsermessages?.forEach(message => {\r\n        const formattedMessages ={}\r\n        formattedMessages['name']= clickedUser?.first_name\r\n        formattedMessages['img']= clickedUser?.url\r\n        formattedMessages['message']= message.message\r\n        formattedMessages['timestamp']=message.timestamp\r\n        messages.push(formattedMessages)\r\n    })\r\n    const decendingOrderMessages = messages?.sort((a,b) => a.timestamp.localeCompare(b.timestamp)) \r\n\r\n    return (\r\n        <>\r\n        <Chat decendingOrderMessages={decendingOrderMessages}/>\r\n        <ChatInput\r\n        user={user}\r\n        clickedUser={clickedUser}\r\n        getUserMessages={getUserMessages}\r\n        getClickedUsersMessages={getClickedUserMessages}/>\r\n        </>\r\n    )\r\n}\r\nexport default ChatDisplay;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}